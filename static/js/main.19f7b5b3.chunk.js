(this["webpackJsonpmessaging-app"]=this["webpackJsonpmessaging-app"]||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var c=n(2),r=n(0),a=n.n(r),s=n(16),i=n.n(s),j=(n(44),n(7)),o=(n(45),n(53)),d=n(57),l=n(54),u=n(58);var b=function(e){var t=e.setId,n=Object(r.useRef)();return Object(c.jsx)(o.a,{className:"align-items-center d-flex",style:{height:"100vh"},children:Object(c.jsxs)(d.a,{onSubmit:function(e){e.preventDefault(),t(n.current.value)},className:"w-100",children:[Object(c.jsxs)(d.a.Group,{children:[Object(c.jsx)(d.a.Label,{children:"Enter your ID"}),Object(c.jsx)(d.a.Control,{type:"text",ref:n,required:!0})]}),Object(c.jsx)(l.a,{type:"submit",className:"mr-3",children:"Login"}),Object(c.jsx)(l.a,{onClick:function(){t(Object(u.a)())},variant:"secondary",children:"create new ID"})]})})};function x(e,t){var n="messaging-app-"+e,c=Object(r.useState)((function(){var e=localStorage.getItem(n);return null!==e?JSON.parse(e):"function"===typeof t?t():t})),a=Object(j.a)(c,2),s=a[0],i=a[1];return Object(r.useEffect)((function(){localStorage.setItem(n,JSON.stringify(s))}),[n,s]),[s,i]}var O=n(60),h=n(59),f=n(56),m=n(61),v=n(19),p=n(17),g=a.a.createContext();function C(){return Object(r.useContext)(g)}function y(e){var t=e.children,n=x("contacts",[]),r=Object(j.a)(n,2),a=r[0],s=r[1];return Object(c.jsx)(g.Provider,{value:{contacts:a,createContact:function(e,t){s((function(n){return[].concat(Object(p.a)(n),[{name:e,id:t}])}))}},children:t})}var I=a.a.createContext();function N(){return Object(r.useContext)(I)}function S(e){var t=e.id,n=e.children,a=C().contacts,s=x("chats",[]),i=Object(j.a)(s,2),o=i[0],d=i[1],l=Object(r.useState)(0),u=Object(j.a)(l,2),b=u[0],O=u[1];var h=o.map((function(e,n){var c=e.recipientIds.map((function(e){var t=a.find((function(t){return t.id===e})),n=t&&t.name||e;return{id:e,name:n}})),r=e.messages.map((function(e){var n=a.find((function(t){return t.id===e.sender})),c=n&&n.name||e.sender,r=t===e.sender;return Object(v.a)(Object(v.a)({},e),{},{senderName:c,fromMe:r})})),s=n===b;return Object(v.a)(Object(v.a)({},o),{},{messages:r,recipientIds:c,selected:s})})),f={chats:h,selectedChat:h[b],selectChatIndex:O,sendMessage:function(e,n){!function(e){var t=e.recipientIds,n=e.text,c=e.sender;d((function(e){var r=!1,a={sender:c,text:n},s=e.map((function(e){return n=e.recipientIds,c=t,n.length===c.length&&(n.sort(),c.sort(),n.every((function(e,t){return e===c[t]})))?(r=!0,Object(v.a)(Object(v.a)({},e),{},{messages:[].concat(Object(p.a)(e.messages),[a])})):e;var n,c}));return r?s:[].concat(Object(p.a)(e),[{recipientIds:t,message:[a]}])}))}({recipientIds:e,text:n,sender:t})},createChat:function(e){d((function(t){return[].concat(Object(p.a)(t),[{recipientIds:e,messages:[]}])}))}};return Object(c.jsx)(I.Provider,{value:f,children:n})}function w(){var e=N(),t=e.chats,n=e.selectChatIndex;return Object(c.jsx)(m.a,{variant:"flush",children:t.map((function(e,t){return Object(c.jsx)(m.a.Item,{action:!0,onClick:function(){return n(t)},active:e.selected,children:e.recipientIds.map((function(e){return e.name})).join(", ")},t)}))})}function M(){var e=C().contacts;return Object(c.jsx)(m.a,{variant:"flush",children:e.map((function(e){return Object(c.jsx)(m.a.Item,{children:e.name},e.id)}))})}function k(e){var t=e.closeModal,n=Object(r.useState)([]),a=Object(j.a)(n,2),s=a[0],i=a[1],o=C().contacts,u=N().createChat;return Object(c.jsxs)("div",{children:[Object(c.jsx)(f.a.Header,{closeButton:!0,children:Object(c.jsx)("h4",{children:"Create Chat"})}),Object(c.jsx)(f.a.Body,{children:Object(c.jsxs)(d.a,{onSubmit:function(e){e.preventDefault(),u(s),t()},children:[o.map((function(e){return Object(c.jsx)(d.a.Group,{controlId:e.id,children:Object(c.jsx)(d.a.Check,{type:"checkbox",value:s.includes(e.id),label:e.name,onChange:function(){return t=e.id,void i((function(e){return s.includes(t)?e.filter((function(e){return e!==t})):[].concat(Object(p.a)(e),[t])}));var t}})},e.id)})),Object(c.jsx)(l.a,{type:"submit",children:"Add Chat"})]})})]})}function D(e){var t=e.closeModal,n=Object(r.useRef)(),a=Object(r.useRef)(),s=C().createContact;return Object(c.jsxs)("div",{children:[Object(c.jsx)(f.a.Header,{closeButton:!0,children:Object(c.jsx)("h4",{children:"Create Contact"})}),Object(c.jsx)(f.a.Body,{children:Object(c.jsxs)(d.a,{onSubmit:function(e){e.preventDefault(),s(n.current.value,a.current.value),t()},children:[Object(c.jsxs)(d.a.Group,{children:[Object(c.jsx)(d.a.Label,{children:"Enter Name"}),Object(c.jsx)(d.a.Control,{type:"text",ref:n,required:!0})]}),Object(c.jsxs)(d.a.Group,{children:[Object(c.jsx)(d.a.Label,{children:"Enter ID"}),Object(c.jsx)(d.a.Control,{type:"text",ref:a,required:!0})]}),Object(c.jsx)(l.a,{type:"submit",children:"Add Contact"})]})})]})}var L="Chats",B="Contacts";function E(e){var t=e.Id,n=Object(r.useState)(L),a=Object(j.a)(n,2),s=a[0],i=a[1],o=s===L,d=Object(r.useState)(!1),u=Object(j.a)(d,2),b=u[0],x=u[1];function m(){x(!1)}return Object(c.jsxs)("div",{style:{width:"25vw"},className:"d-flex flex-column",children:[Object(c.jsxs)(O.a.Container,{activeKey:s,onSelect:i,children:[Object(c.jsxs)(h.a,{variant:"tabs",className:"justify-content-center",children:[Object(c.jsx)(h.a.Item,{children:Object(c.jsx)(h.a.Link,{eventKey:L,children:"Chats"})}),Object(c.jsx)(h.a.Item,{children:Object(c.jsx)(h.a.Link,{eventKey:B,children:"Contacts"})})]}),Object(c.jsxs)(O.a.Content,{className:"border-right overflow-auto flex-grow-1",children:[Object(c.jsx)(O.a.Pane,{eventKey:L,children:Object(c.jsx)(w,{})}),Object(c.jsx)(O.a.Pane,{eventKey:B,children:Object(c.jsx)(M,{})})]}),Object(c.jsxs)("div",{className:"p-2 border-top border-right small",children:["your ID: ",Object(c.jsx)("span",{className:"text-muted",children:t})]}),Object(c.jsxs)(l.a,{className:"rounded-0",onClick:function(){return x(!0)},children:["New ",o?"Chat":"Contact"]})]}),Object(c.jsx)(f.a,{show:b,onHide:m,children:o?Object(c.jsx)(k,{closeModal:m}):Object(c.jsx)(D,{closeModal:m})})]})}var G=n(55);function K(){var e=Object(r.useState)(""),t=Object(j.a)(e,2),n=t[0],a=t[1],s=N(),i=s.sendMessage,o=s.selectedChat;return Object(c.jsxs)("div",{className:"d-flex flex-column flex-grow-1",children:[Object(c.jsx)("div",{className:"flex-grow-1 overflow-auto",children:Object(c.jsx)("div",{className:"d-flex flex-column align-items-start justify-content-end px-3",children:o.messages.map((function(e,t){return Object(c.jsxs)("div",{className:"my-1 d-flex flex-column ".concat(e.fromMe?"align-self-end":""),children:[Object(c.jsx)("div",{className:"rounded px-2 py-1 ".concat(e.fromMe?"bg-primary text-white":"border"),children:e.text}),Object(c.jsx)("div",{className:"text-muted small ".concat(e.fromMe?"text-right":""),children:e.fromMe?"you":e.senderName})]},t)}))})}),Object(c.jsx)(d.a,{onSubmit:function(e){e.preventDefault(),i(o.recipientIds.map((function(e){return e.id})),n),a("")},children:Object(c.jsx)(d.a.Group,{className:"m-2",children:Object(c.jsxs)(G.a,{children:[Object(c.jsx)(d.a.Control,{as:"textarea",required:!0,value:n,onChange:function(e){return a(e.target.value)},style:{height:"75px",resize:"none"}}),Object(c.jsx)(G.a.Append,{children:Object(c.jsx)(l.a,{className:"p-3",type:"submit",children:"Send"})})]})})})]})}function q(e){var t=e.Id,n=N().selectedChat;return Object(c.jsxs)("div",{className:"d-flex",style:{height:"100vh"},children:[Object(c.jsx)(E,{Id:t}),n&&Object(c.jsx)(K,{})]})}var A=function(){var e=x("Id"),t=Object(j.a)(e,2),n=t[0],r=t[1],a=Object(c.jsx)(y,{children:Object(c.jsx)(S,{id:n,children:Object(c.jsx)(q,{Id:n})})});return Object(c.jsx)("div",{className:"App",children:n?a:Object(c.jsx)(b,{setId:r})})};n(49);i.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(A,{})}),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.19f7b5b3.chunk.js.map